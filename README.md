# HavenShield ğŸ›¡
> A **fully automated, open-source SOC** for home labs â€” built with Wazuh, Shuffle, and TheHive                                                                 


<a href="https://wazuh.com/"><img width="115.821428572" height="73.928571428" alt="image" src="https://github.com/user-attachments/assets/cb9e2183-f12b-4952-a3d9-8041fedb3209" /></a>
<a href="https://strangebee.com/thehive/"><img width="120" height="60" alt="image" src="https://github.com/user-attachments/assets/07558961-807f-40ed-8ece-7b60af1e244a" /></a>
<a href="https://suricata.io/"><img width="130.909090909" height="73.636363637" alt="image" src="https://github.com/user-attachments/assets/fadf3c22-af14-4e2d-a2a1-c630778bf2c5" /></a>
<a href="https://shuffler.io/"><img width="120" height="60" alt="image" src="https://github.com/user-attachments/assets/667854a6-c06a-44b1-94a9-02376155c946" /></a>
<a href="https://www.virustotal.com"><img width="129.375" height="62.8125" alt="image" src="https://github.com/user-attachments/assets/ee65c4ca-4539-4639-8ad0-dadc9249a796" /></a>

# âœ¨ Features
  - **Automated Response**: Conditional blocking (VirusTotal + whitelist checks)
  - **Case Management**: TheHive integration for analyst workflows
  - **Zero Cost**: 100% free/open-source (AGPLv3/Apache 2.0/GPLv2)

# ğŸ“ Full Repository Structure 
```js
HavenShield/
â”œâ”€â”€ README.md                 # Project overview + architecture diagram
â”œâ”€â”€ LICENSE                   # AGPLv3 license
â”œâ”€â”€ CHANGELOG.md              # Version history (shows project evolution)
â”œâ”€â”€ .gitignore                # Exclude secrets/temp files
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ deployment-guide.md   # Step-by-step setup per VM
â”‚   â”œâ”€â”€ troubleshooting.md    # Fix common issues (Cassandra crashes, etc.)
â”‚   â””â”€â”€ screenshots/          # Visual proof (dashboard, case creation)
â”‚       â”œâ”€â”€ soc-architecture.png
â”‚       â””â”€â”€ wazuh-dashboard.png
â”‚       
â”œâ”€â”€ deploy/
â”‚   â”œâ”€â”€ siem/                 # Wazuh Manager (192.168.0.100)
â”‚   â”‚   â”œâ”€â”€ install.sh
â”‚   â”‚   â””â”€â”€ wazuh.conf        # Minimal custom config
â”‚   â”œâ”€â”€ soar/                 # Shuffle SOAR (192.168.0.101)
â”‚   â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â”‚   â””â”€â”€ .env.example      # Template (no secrets)
â”‚   â”œâ”€â”€ case/                 # TheHive (192.168.0.102)
â”‚   â”‚   â””â”€â”€ docker-compose.yml
â”‚   â””â”€â”€ endpoint/             # Vuln Machine (192.168.0.114)
â”‚       â”œâ”€â”€ install-suricata.sh
â”‚       â””â”€â”€ install-agent.sh  # Wazuh Agent setup
â”œâ”€â”€ integrations/
â”‚   â””â”€â”€ wazuh-to-shuffle.py  # Secure webhook sender (HTTPS-ready)
â””â”€â”€ playbooks/
    â””â”€â”€ ssh-auto-block.json   # Exported Shuffle workflow
```


## ğŸš€Architecture Overview
HavenShield implements a three-tier SOC architecture aligned with NIST SP 800-61r2 incident response guidelines:                                              
```js
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          
â”‚                         HAVENSHIELD SOC ARCHITECTURE                        â”‚                                                
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                                  
â”‚                                                                             â”‚                                                                
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                                                          
â”‚  â”‚   Detection      â”‚     â”‚   Orchestration  â”‚     â”‚   Investigation   â”‚    â”‚                                                  
â”‚  â”‚   Layer          â”‚â”€â”€â”€â”€â–¶â”‚   Layer          â”‚â”€â”€â”€â”€â–¶â”‚   Layer           â”‚    â”‚                                              
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚                                                      
â”‚  â”‚ â€¢ Wazuh Manager  â”‚     â”‚ â€¢ Shuffle SOAR   â”‚     â”‚ â€¢ TheHive 5       â”‚    â”‚                                              
â”‚  â”‚ â€¢ Suricata IDS   â”‚     â”‚ â€¢ Conditional    â”‚     â”‚ â€¢ VirusTotal API  â”‚    â”‚                                                
â”‚  â”‚ â€¢ OpenSearch DB  â”‚     â”‚   Playbooks      â”‚     â”‚ â€¢ Case Management â”‚    â”‚                                                                              
â”‚  â”‚ â€¢ Agent Network  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â€¢ Task Workflows  â”‚    â”‚                                                                            
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                                                                
â”‚                                                                             â”‚                                                                              
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                          
```
## ğŸ—¡ï¸ Component Specifications :
```js
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
| Component         | Version | Role                          | Resource Requirements  | Configuration Focus                             |
|â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€|â”€â”€â”€â”€â”€â”€â”€â”€â”€|â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€|â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€|â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€|
| **Wazuh Manager** | 4.7.1   | SIEM / Log Aggregation        | 4 GB RAM, 2 vCPU       | Custom rule development, alert tuning           |
| **Shuffle**       | 1.1.0   | SOAR / Automation Engine      | 2 GB RAM, 2 vCPU       | Judgment-based playbooks, whitelist integration |
| **TheHive**       | 4.1.15  | Case Management               | 6 GB RAM, 2 vCPU       | Cassandra stability tuning, analyst workflows   |
| **VirusTotal**    | API v3  | Threat Intelligence           | N/A (cloud service)    | Reputation threshold calibration                |
| **Suricata**      | 6.0.10  | Network IDS/IPS               | 2 GB RAM, 2 vCPU       | Custom signatures, threshold tuning             |
| **OpenSearch**    | 2.11.1  | Search & Analytics Engine     | 2 GB RAM (shared)      | Index optimization, security hardening          |
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
## âš”ï¸ Network Topology :
```js
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚               HOME LAB NETWORK (192.168.0.0/24)                 â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚   SIEM        â”‚    â”‚   SOAR        â”‚    â”‚   CASE        â”‚    â”‚
  â”‚  â”‚  Server       â”‚    â”‚  Server       â”‚    â”‚  Server       â”‚    â”‚
  â”‚  â”‚  192.168.0.100â”‚    â”‚  192.168.0.101â”‚    â”‚  192.168.0.102â”‚    â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
  â”‚  â”‚ â€¢ Wazuh       â”‚    â”‚ â€¢ Shuffle     â”‚    â”‚ â€¢ TheHive     â”‚    â”‚
  â”‚  â”‚ â€¢ OpenSearch  â”‚    â”‚ â€¢ SQLite      â”‚    â”‚ â€¢ Cassandra   â”‚    â”‚
  â”‚  â”‚ â€¢ Dashboard   â”‚    â”‚ â€¢ Playbooks   â”‚    â”‚ â€¢ Cortex      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚         â”‚                    â”‚                    â”‚             â”‚
  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
  â”‚                              â”‚                                  â”‚
  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
  â”‚                    â”‚                     â”‚                      â”‚
  â”‚              â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚              â”‚ Vuln         â”‚      â”‚ Laptop      â”‚              â”‚
  â”‚              â”‚ Machine      â”‚      â”‚ (Analyst)   â”‚              â”‚
  â”‚              â”‚ 192.168.0.114â”‚      â”‚ 192.168.0.50â”‚              â”‚
  â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚              â”‚ â€¢ Wazuh      â”‚                                   â”‚
  â”‚              â”‚   Agent      â”‚                                   â”‚
  â”‚              â”‚ â€¢ Suricata   â”‚                                   â”‚
  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
  â”‚                                                                 â”‚
  â”‚                                                                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```  
